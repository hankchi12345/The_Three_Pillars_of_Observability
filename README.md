# 微服務觀測性 (Observability for Microservices)
---
### 第 1 章	什麼是觀測性？
### 第 2 章	搭建本地微服務
### 第 3 章	加入 Tracing：OpenTelemetry + Jaeger
### 第 4 章	加入 Metrics：Prometheus + Exporter
### 第 5 章	加入 Logs：Loki + Grafana 日誌串流
### 第 6 章	統一儀表板：Grafana 整合三大支柱
### 第 7 章	警報系統設計：Prometheus + Alertmanager
### 第 8 章	總結：打造一個可擴充的監控架構
---
## __什麼是觀測性？__
#### *1.1觀測性（Observability）來自控制工程領域，意思是：*

從系統輸出的訊號，推斷其內部運作狀況的能力。

通俗地講，就像你不需要打開電腦機箱，也能透過 CPU 使用率、風扇轉速和功耗等數據，推斷出電腦內部的溫度變化

**監控 (Monitoring) 與 觀測性 (Observability) 的區別：**
| 類別   | 說明                             | 重點                                 |             差異             |
| :----- | :------------------------------- | :----------------------------------- | :--------------------------- |
| 監控   | 收集與呈現預期內的系統狀況（例如 CPU、記憶體） | 有既定監控項目         | **面對已知問題的反應能力**   |
| 觀測性 | 能在未知錯誤發生時，快速找到發生地點與原因 | 面對未知問題的探索能力     | **面對未知問題的探索能力**   |

監控像是體檢表，觀測性像通靈你需要預想有機會發生的事

#### *1.2. 観測性的三大支柱（The Three Pillars）*
| 支柱名稱            | 功能說明         | 常見用途          | 工具範例                                    |
| --------------- | ------------ | ------------- | --------------------------------------- |
| **Metrics（指標）** | 數值型、可量化的系統狀態 | 偵測趨勢、設計告警     | Prometheus、Grafana                      |
| **Logs（日誌）**    | 系統事件的文字紀錄    | 錯誤分析、除錯追蹤     | Loki、ELK（Elasticsearch、Logstash、Kibana） |
| **Traces（追蹤）**  | 跨服務之間的請求流程紀錄 | 微服務呼叫鏈、效能瓶頸定位 | OpenTelemetry、Jaeger、Zipkin             |

#### *1.3 實作的架構（示意圖）*

<pre><code>
                  +----------------------+
                  |     Grafana          |
                  |(視覺化：圖表/追蹤/日誌) |
                  +----------+-----------+
                             |
            +-------------------------------+
            |            Prometheus         |
            | (抓 metrics + 發警報 + 查詢)  |
            +----------+----------+---------+
                       |          |
         +-------------+          +------------+
         |                                      |
+--------v---------+                  +--------v--------+
|   Node Exporter  |                  |   OpenTelemetry |
| (系統資源監控)  |                  |  SDK + Collector |
+------------------+                  +--------+--------+
                                               |
                      +------------------------+----------------+
                      |                         |                |
              +-------v------+         +--------v------+  +------v-------+
              |  Service A   |         |  Service B   |  |  Service C    |
              +--------------+         +---------------+ +---------------+
                  |                        |                  |
               Logs/Trace             Logs/Trace         Logs/Trace
                  |                        |                  |
              +---v------------------------v------------------v---+
              |                     Loki + Jaeger                |
              +--------------------------------------------------+

</code></pre>
---
### ___搭建本地微服務___
用 Node.js（Express）建立三層微服務，並模擬請求從 A → B → C 的流程，為追蹤系統（Tracing）鋪路

---
*目錄結構*
<pre><code>
microservices-demo/
├── service-a/
│   └── index.js
├── service-b/
│   └── index.js
├── service-c/
│   └── index.js
└── docker-compose.yml   # （第 3 章會開始用）

</code></pre>
---
流程圖
<pre><code>
[ 使用者請求 ]
       |
   [Service A] #A：接收 /hello，呼叫 B 並包裝回傳
       |
   [Service B] #B：處理 /step2，呼叫 C 並包裝回傳
       |
   [Service C] #C：處理 /step3，單純回應資料
       |
   回傳結果 → 使用者
</code></pre>

